{% comment %} <!--
    Crude content parser to inject Glossary tooltips. Don't judge me.
--> {% endcomment %}
{% assign glossary = site.pages | where:"ref", "glossary" | where:"lang", page.lang | first %}
{% if glossary == null %}
    {% assign glossary = site.pages | where:"ref", "glossary" | where:"lang", "en" | first %}
{% endif %}
{% assign lines = include.md_content | newline_to_br | split:'<br />' %}
{% for line in lines -%}
    {%- assign words = line | split:' ' -%}
    {%- for word in words -%}
        {%- assign word_clean = word | strip_html | downcase |
            remove:'(' | remove:')' | remove:'[' | remove:']' | remove:'^' | remove:'-' | remove:'.' | remove:',' | remove:'!' | remove:'?' | remove:"'" |
            remove:'0' | remove:'1' | remove:'2' | remove:'3' | remove:'4' | remove:'5' | remove:'6' | remove:'7' | remove:'8' | remove:'9' -%}
        {%- if glossary.terms[word_clean] != null -%}
            <span class="tooltip" onmouseenter="placeTooltip(this)"><span class="tooltiptext">{{ glossary.terms[word_clean] }}</span>{{ word }}</span>
        {%- else -%}
            {{ word }}
        {%- endif %} {% endfor %}
{% endfor %}
